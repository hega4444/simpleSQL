    ('Eva', 'Williams', 'IT', 60000),
    ('Michael', 'Anderson', 'IT', 62000),
    ('Sarah', 'Clark', 'Marketing', 52000),
    ('David', 'Hall', 'Marketing', 53000),
    ('Emily', 'Young', 'Finance', 65000),
    ('Robert', 'Lee', 'Finance', 66000),
    ('Maria', 'Garcia', 'R&D', 70000),
    ('Daniel', 'Martin', 'R&D', 71000),
    ('William', 'Wilson', 'HR', 49000),
    ('Linda', 'Brown', 'Sales', 57000),
    ('Richard', 'Moore', 'IT', 61000),
    ('Susan', 'Taylor', 'Marketing', 54000),
    ('Joseph', 'Hall', 'Finance', 67000),
    ('Nancy', 'Harris', 'R&D', 72000),
    ('Thomas', 'Thompson', 'HR', 48000),
    ('Patricia', 'Hernandez', 'IT', 59000);
execute
CREATE TABLE departments (
    department_id serial PRIMARY KEY,
    department_name VARCHAR(50)
);
INSERT INTO departments (department_name)
VALUES
    ('HR'),
    ('Sales'),
    ('IT'),
    ('Marketing'),
    ('Finance'),
    ('R&D');
execute
INSERT INTO departments (department_name)
VALUES
    ('HR'),
    ('Sales'),
    ('IT'),
    ('Marketing'),
    ('Finance'),
    ('R&D');
end recording
y
employees
play employees
list recordings
play recording employees
clear
SELECT first_name, last_name, salary
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);
SELECT first_name, last_name, salary
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);
show employees
SELECT first_name, last_name, salary
FROM employees
WHERE salary IN (SELECT salary FROM employees WHERE salary > 60000.00 AND salary < 72000.00);
SELECT department, AVG(salary) 
FROM employees GROUP BY department
HAVING AVG(salary)>=ALL 
(SELECT AVG(salary) FROM employees 
GROUP BY department);
SELECT department_name
FROM departments d
WHERE NOT EXISTS (
    SELECT 1
    FROM employees
    WHERE department = d.department_name
);
SELECT department_name
FROM departments
WHERE department_name = (
    SELECT department
    FROM employees
    GROUP BY department
    HAVING AVG(salary) = (
        SELECT MAX(avg_salary)
        FROM (
            SELECT department, AVG(salary) as avg_salary
            FROM employees
            GROUP BY department
        ) AS subquery
    )
);
SELECT department_name
FROM departments
WHERE department_name = (
    SELECT department
    FROM employees
    GROUP BY department
    HAVING AVG(salary) = (
        SELECT MAX(avg_salary)
        FROM (
            SELECT department, AVG(salary) as avg_salary
            FROM employees
            GROUP BY department
        ) AS subquery
    )
);
show employees
show departments
close
